<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.1.2 (20260124.0452)
 -->
<!-- Title: SparkSessionOperator Pages: 1 -->
<svg width="2168pt" height="593pt"
 viewBox="0.00 0.00 2168.00 593.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 588.53)">
<title>SparkSessionOperator</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-588.53 2164.38,-588.53 2164.38,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_clients</title>
<polygon fill="none" stroke="#94a3b8" stroke-dasharray="5,2" points="8,-170.9 8,-542.53 374,-542.53 374,-170.9 8,-170.9"/>
<text xml:space="preserve" text-anchor="middle" x="32.5" y="-528.08" font-family="Helvetica,sans-Serif" font-size="11.00" fill="#64748b">Clients</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_ingress</title>
<polygon fill="#fff7ed" stroke="#fb923c" points="501,-327.81 501,-421.56 955,-421.56 955,-327.81 501,-327.81"/>
<text xml:space="preserve" text-anchor="middle" x="573.12" y="-407.11" font-family="Helvetica,sans-Serif" font-size="11.00"> &#160;Nginx Ingress Controller &#160;</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_operator</title>
<polygon fill="#f0fdf4" stroke="#4ade80" points="382,-144 382,-305.81 1330,-305.81 1330,-144 382,-144"/>
<text xml:space="preserve" text-anchor="middle" x="480.38" y="-291.36" font-family="Helvetica,sans-Serif" font-size="11.00"> &#160;spark&#45;session&#45;operator namespace &#160;</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_binary</title>
<polygon fill="#dcfce7" stroke="#86efac" points="402,-164 402,-265.81 1310,-265.81 1310,-164 402,-164"/>
<text xml:space="preserve" text-anchor="middle" x="448.62" y="-251.36" font-family="Helvetica,sans-Serif" font-size="11.00"> &#160;Operator Pod &#160;</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_k8s</title>
<polygon fill="#eff6ff" stroke="#60a5fa" points="275,-22 275,-110 894,-110 894,-22 275,-22"/>
<text xml:space="preserve" text-anchor="middle" x="344.5" y="-95.55" font-family="Helvetica,sans-Serif" font-size="11.00"> &#160;Kubernetes API Server &#160;</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_spark</title>
<polygon fill="#faf5ff" stroke="#c084fc" points="1338,-8 1338,-576.53 1834,-576.53 1834,-8 1338,-8"/>
<text xml:space="preserve" text-anchor="middle" x="1404.88" y="-562.08" font-family="Helvetica,sans-Serif" font-size="11.00"> &#160;spark&#45;dev namespace &#160;</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_cp</title>
<polygon fill="#f3e8ff" stroke="#d8b4fe" points="1358,-28 1358,-536.53 1472,-536.53 1472,-28 1358,-28"/>
<text xml:space="preserve" text-anchor="middle" x="1414.75" y="-522.08" font-family="Helvetica,sans-Serif" font-size="11.00">connect&#45;default&#45;pool</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_tp</title>
<polygon fill="#f3e8ff" stroke="#d8b4fe" points="1492,-28 1492,-536.53 1618,-536.53 1618,-28 1492,-28"/>
<text xml:space="preserve" text-anchor="middle" x="1540.5" y="-522.08" font-family="Helvetica,sans-Serif" font-size="11.00">thrift&#45;default&#45;pool</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_pool_n</title>
<polygon fill="#f9fafb" stroke="#cbd5e1" stroke-dasharray="5,2" points="1638,-460.53 1638,-536.53 1716,-536.53 1716,-460.53 1638,-460.53"/>
<text xml:space="preserve" text-anchor="middle" x="1674.5" y="-522.08" font-family="Helvetica,sans-Serif" font-size="11.00" fill="#94a3b8">your&#45;pool&#45;N</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_pool_m</title>
<polygon fill="#f9fafb" stroke="#cbd5e1" stroke-dasharray="5,2" points="1736,-460.53 1736,-536.53 1814,-536.53 1814,-460.53 1736,-460.53"/>
<text xml:space="preserve" text-anchor="middle" x="1772.88" y="-522.08" font-family="Helvetica,sans-Serif" font-size="11.00" fill="#94a3b8">your&#45;pool&#45;M</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_ext</title>
<polygon fill="none" stroke="#94a3b8" stroke-dasharray="5,2" points="1842,-454.53 1842,-542.53 2057,-542.53 2057,-454.53 1842,-454.53"/>
<text xml:space="preserve" text-anchor="middle" x="1892" y="-528.08" font-family="Helvetica,sans-Serif" font-size="11.00" fill="#64748b">External Services</text>
</g>
<!-- jupyter -->
<g id="node1" class="node">
<title>jupyter</title>
<polygon fill="#dbeafe" stroke="black" points="250.38,-506.53 155.62,-506.53 155.62,-502.53 151.62,-502.53 151.62,-498.53 155.62,-498.53 155.62,-478.53 151.62,-478.53 151.62,-474.53 155.62,-474.53 155.62,-470.53 250.38,-470.53 250.38,-506.53"/>
<polyline fill="none" stroke="black" points="155.62,-502.53 159.62,-502.53 159.62,-498.53 155.62,-498.53"/>
<polyline fill="none" stroke="black" points="155.62,-478.53 159.62,-478.53 159.62,-474.53 155.62,-474.53"/>
<text xml:space="preserve" text-anchor="middle" x="203" y="-490.28" font-family="Helvetica,sans-Serif" font-size="10.00">Jupyter / PySpark</text>
<text xml:space="preserve" text-anchor="middle" x="203" y="-479.03" font-family="Helvetica,sans-Serif" font-size="10.00">(Spark Connect)</text>
</g>
<!-- ing_connect -->
<g id="node5" class="node">
<title>ing_connect</title>
<polygon fill="#fef3c7" stroke="black" points="779.12,-379.56 670.88,-379.56 670.88,-349.81 779.12,-349.81 791.12,-364.68 779.12,-379.56"/>
<text xml:space="preserve" text-anchor="middle" x="731" y="-372.06" font-family="Helvetica,sans-Serif" font-size="10.00">*&#45;connect Ingress</text>
<text xml:space="preserve" text-anchor="middle" x="731" y="-360.81" font-family="Helvetica,sans-Serif" font-size="10.00">spark&#45;connect&#45;*.host</text>
<text xml:space="preserve" text-anchor="middle" x="731" y="-349.56" font-family="Helvetica,sans-Serif" font-size="10.00">backend: GRPC :15002</text>
</g>
<!-- jupyter&#45;&gt;ing_connect -->
<g id="edge1" class="edge">
<title>jupyter&#45;&gt;ing_connect</title>
<path fill="none" stroke="#3b82f6" d="M231.46,-470.06C242.49,-464.11 255.46,-458.08 268,-454.53 439.2,-406.02 503.11,-490.86 667,-421.56 681.72,-415.33 695.45,-404.36 706.39,-393.78"/>
<polygon fill="#3b82f6" stroke="#3b82f6" points="708.6,-396.52 713.11,-386.93 703.61,-391.61 708.6,-396.52"/>
<text xml:space="preserve" text-anchor="middle" x="673.79" y="-430.96" font-family="Helvetica,sans-Serif" font-size="8.00">sc://spark&#45;connect&#45;*</text>
</g>
<!-- dbeaver -->
<g id="node2" class="node">
<title>dbeaver</title>
<polygon fill="#dbeafe" stroke="black" points="119.75,-506.53 24.25,-506.53 24.25,-502.53 20.25,-502.53 20.25,-498.53 24.25,-498.53 24.25,-478.53 20.25,-478.53 20.25,-474.53 24.25,-474.53 24.25,-470.53 119.75,-470.53 119.75,-506.53"/>
<polyline fill="none" stroke="black" points="24.25,-502.53 28.25,-502.53 28.25,-498.53 24.25,-498.53"/>
<polyline fill="none" stroke="black" points="24.25,-478.53 28.25,-478.53 28.25,-474.53 24.25,-474.53"/>
<text xml:space="preserve" text-anchor="middle" x="72" y="-490.28" font-family="Helvetica,sans-Serif" font-size="10.00">DBeaver / PyHive</text>
<text xml:space="preserve" text-anchor="middle" x="72" y="-479.03" font-family="Helvetica,sans-Serif" font-size="10.00">(Thrift HTTP)</text>
</g>
<!-- ing_thrift -->
<g id="node6" class="node">
<title>ing_thrift</title>
<polygon fill="#fef3c7" stroke="black" points="622.62,-379.56 517.38,-379.56 517.38,-349.81 622.62,-349.81 634.62,-364.68 622.62,-379.56"/>
<text xml:space="preserve" text-anchor="middle" x="576" y="-372.06" font-family="Helvetica,sans-Serif" font-size="10.00">*&#45;thrift Ingress</text>
<text xml:space="preserve" text-anchor="middle" x="576" y="-360.81" font-family="Helvetica,sans-Serif" font-size="10.00">spark&#45;thrift&#45;*.host</text>
<text xml:space="preserve" text-anchor="middle" x="576" y="-349.56" font-family="Helvetica,sans-Serif" font-size="10.00">backend: HTTP :10009</text>
</g>
<!-- dbeaver&#45;&gt;ing_thrift -->
<g id="edge2" class="edge">
<title>dbeaver&#45;&gt;ing_thrift</title>
<path fill="none" stroke="#f59e0b" d="M100.94,-470.1C112.14,-464.16 125.3,-458.12 138,-454.53 178.25,-443.14 474.58,-438.1 513,-421.56 527.41,-415.35 540.81,-404.53 551.51,-394.05"/>
<polygon fill="#f59e0b" stroke="#f59e0b" points="553.99,-396.53 558.43,-386.91 548.96,-391.66 553.99,-396.53"/>
<text xml:space="preserve" text-anchor="middle" x="498.74" y="-430.96" font-family="Helvetica,sans-Serif" font-size="8.00">JDBC http transport</text>
</g>
<!-- restcli -->
<g id="node3" class="node">
<title>restcli</title>
<polygon fill="#dbeafe" stroke="black" points="357.75,-506.53 286.25,-506.53 286.25,-502.53 282.25,-502.53 282.25,-498.53 286.25,-498.53 286.25,-478.53 282.25,-478.53 282.25,-474.53 286.25,-474.53 286.25,-470.53 357.75,-470.53 357.75,-506.53"/>
<polyline fill="none" stroke="black" points="286.25,-502.53 290.25,-502.53 290.25,-498.53 286.25,-498.53"/>
<polyline fill="none" stroke="black" points="286.25,-478.53 290.25,-478.53 290.25,-474.53 286.25,-474.53"/>
<text xml:space="preserve" text-anchor="middle" x="322" y="-490.28" font-family="Helvetica,sans-Serif" font-size="10.00">REST Client</text>
<text xml:space="preserve" text-anchor="middle" x="322" y="-479.03" font-family="Helvetica,sans-Serif" font-size="10.00">(curl / UI)</text>
</g>
<!-- ing_gw -->
<g id="node7" class="node">
<title>ing_gw</title>
<polygon fill="#fef3c7" stroke="black" points="927,-379.56 827,-379.56 827,-349.81 927,-349.81 939,-364.68 927,-379.56"/>
<text xml:space="preserve" text-anchor="middle" x="883" y="-372.06" font-family="Helvetica,sans-Serif" font-size="10.00">gateway Ingress</text>
<text xml:space="preserve" text-anchor="middle" x="883" y="-360.81" font-family="Helvetica,sans-Serif" font-size="10.00">spark&#45;api.host</text>
<text xml:space="preserve" text-anchor="middle" x="883" y="-349.56" font-family="Helvetica,sans-Serif" font-size="10.00">backend: HTTP :8080</text>
</g>
<!-- restcli&#45;&gt;ing_gw -->
<g id="edge3" class="edge">
<title>restcli&#45;&gt;ing_gw</title>
<path fill="none" stroke="#6b7280" d="M358.07,-485.62C458.62,-479.88 740.07,-460.64 823,-421.56 836.72,-415.09 849.41,-404.33 859.55,-393.97"/>
<polygon fill="#6b7280" stroke="#6b7280" points="861.83,-396.66 866.08,-386.95 856.71,-391.89 861.83,-396.66"/>
<text xml:space="preserve" text-anchor="middle" x="812.52" y="-430.96" font-family="Helvetica,sans-Serif" font-size="8.00">HTTP</text>
</g>
<!-- kubectl -->
<g id="node4" class="node">
<title>kubectl</title>
<polygon fill="#dbeafe" stroke="black" points="357.5,-222.9 290.5,-222.9 290.5,-218.9 286.5,-218.9 286.5,-214.9 290.5,-214.9 290.5,-194.9 286.5,-194.9 286.5,-190.9 290.5,-190.9 290.5,-186.9 357.5,-186.9 357.5,-222.9"/>
<polyline fill="none" stroke="black" points="290.5,-218.9 294.5,-218.9 294.5,-214.9 290.5,-214.9"/>
<polyline fill="none" stroke="black" points="290.5,-194.9 294.5,-194.9 294.5,-190.9 290.5,-190.9"/>
<text xml:space="preserve" text-anchor="middle" x="324" y="-201.03" font-family="Helvetica,sans-Serif" font-size="10.00">kubectl / CI</text>
</g>
<!-- crd_sess -->
<g id="node15" class="node">
<title>crd_sess</title>
<polygon fill="#bfdbfe" stroke="black" points="746.25,-74 629.75,-74 629.75,-38 752.25,-38 752.25,-68 746.25,-74"/>
<polyline fill="none" stroke="black" points="746.25,-74 746.25,-68"/>
<polyline fill="none" stroke="black" points="752.25,-68 746.25,-68"/>
<text xml:space="preserve" text-anchor="middle" x="691" y="-57.75" font-family="Helvetica,sans-Serif" font-size="10.00">SparkInteractiveSession</text>
<text xml:space="preserve" text-anchor="middle" x="691" y="-46.5" font-family="Helvetica,sans-Serif" font-size="10.00">CRD</text>
</g>
<!-- kubectl&#45;&gt;crd_sess -->
<g id="edge4" class="edge">
<title>kubectl&#45;&gt;crd_sess</title>
<path fill="none" stroke="#6b7280" stroke-dasharray="5,2" d="M340.03,-186.4C353.11,-173.07 372.7,-155.15 393,-144 401.87,-139.13 470.29,-119.76 480.25,-118 509.13,-112.89 584.21,-119.39 612,-110 630.35,-103.8 648.48,-92.15 662.72,-81.35"/>
<polygon fill="#6b7280" stroke="#6b7280" points="664.61,-84.32 670.3,-75.38 660.28,-78.82 664.61,-84.32"/>
<text xml:space="preserve" text-anchor="middle" x="503.12" y="-123.9" font-family="Helvetica,sans-Serif" font-size="8.00">kubectl apply</text>
</g>
<!-- connect_p -->
<g id="node8" class="node">
<title>connect_p</title>
<polygon fill="#bbf7d0" stroke="black" points="913.62,-225.78 806.38,-225.78 802.38,-221.78 802.38,-184.03 909.62,-184.03 913.62,-188.03 913.62,-225.78"/>
<polyline fill="none" stroke="black" points="909.62,-221.78 802.38,-221.78"/>
<polyline fill="none" stroke="black" points="909.62,-221.78 909.62,-184.03"/>
<polyline fill="none" stroke="black" points="909.62,-221.78 913.62,-225.78"/>
<text xml:space="preserve" text-anchor="middle" x="858" y="-212.28" font-family="Helvetica,sans-Serif" font-size="10.00">Connect gRPC Proxy</text>
<text xml:space="preserve" text-anchor="middle" x="858" y="-201.03" font-family="Helvetica,sans-Serif" font-size="10.00">:15002</text>
<text xml:space="preserve" text-anchor="middle" x="858" y="-189.78" font-family="Helvetica,sans-Serif" font-size="10.00">metadata/proto auth</text>
</g>
<!-- ing_connect&#45;&gt;connect_p -->
<g id="edge5" class="edge">
<title>ing_connect&#45;&gt;connect_p</title>
<path fill="none" stroke="#3b82f6" d="M750.42,-343.52C760.69,-332.6 773.34,-318.74 784,-305.81 802.88,-282.91 822.83,-255.79 837.25,-235.58"/>
<polygon fill="#3b82f6" stroke="#3b82f6" points="840.05,-237.69 842.98,-227.51 834.34,-233.64 840.05,-237.69"/>
</g>
<!-- thrift_p -->
<g id="node9" class="node">
<title>thrift_p</title>
<polygon fill="#bbf7d0" stroke="black" points="766.12,-225.78 673.88,-225.78 669.88,-221.78 669.88,-184.03 762.12,-184.03 766.12,-188.03 766.12,-225.78"/>
<polyline fill="none" stroke="black" points="762.12,-221.78 669.88,-221.78"/>
<polyline fill="none" stroke="black" points="762.12,-221.78 762.12,-184.03"/>
<polyline fill="none" stroke="black" points="762.12,-221.78 766.12,-225.78"/>
<text xml:space="preserve" text-anchor="middle" x="718" y="-212.28" font-family="Helvetica,sans-Serif" font-size="10.00">Thrift HTTP Proxy</text>
<text xml:space="preserve" text-anchor="middle" x="718" y="-201.03" font-family="Helvetica,sans-Serif" font-size="10.00">:10009</text>
<text xml:space="preserve" text-anchor="middle" x="718" y="-189.78" font-family="Helvetica,sans-Serif" font-size="10.00">Basic auth</text>
</g>
<!-- ing_thrift&#45;&gt;thrift_p -->
<g id="edge6" class="edge">
<title>ing_thrift&#45;&gt;thrift_p</title>
<path fill="none" stroke="#f59e0b" d="M607.16,-343.56C621.73,-333.29 638.75,-319.98 652,-305.81 671.8,-284.63 689.61,-256.89 701.73,-236.01"/>
<polygon fill="#f59e0b" stroke="#f59e0b" points="704.72,-237.82 706.61,-227.4 698.63,-234.36 704.72,-237.82"/>
</g>
<!-- gateway -->
<g id="node10" class="node">
<title>gateway</title>
<polygon fill="#bbf7d0" stroke="black" points="1053.88,-225.78 954.12,-225.78 950.12,-221.78 950.12,-184.03 1049.88,-184.03 1053.88,-188.03 1053.88,-225.78"/>
<polyline fill="none" stroke="black" points="1049.88,-221.78 950.12,-221.78"/>
<polyline fill="none" stroke="black" points="1049.88,-221.78 1049.88,-184.03"/>
<polyline fill="none" stroke="black" points="1049.88,-221.78 1053.88,-225.78"/>
<text xml:space="preserve" text-anchor="middle" x="1002" y="-212.28" font-family="Helvetica,sans-Serif" font-size="10.00">REST API Gateway</text>
<text xml:space="preserve" text-anchor="middle" x="1002" y="-201.03" font-family="Helvetica,sans-Serif" font-size="10.00">:8080</text>
<text xml:space="preserve" text-anchor="middle" x="1002" y="-189.78" font-family="Helvetica,sans-Serif" font-size="10.00">OIDC Bearer</text>
</g>
<!-- ing_gw&#45;&gt;gateway -->
<g id="edge7" class="edge">
<title>ing_gw&#45;&gt;gateway</title>
<path fill="none" stroke="#6b7280" d="M900.93,-343.43C910.41,-332.49 922.11,-318.63 932,-305.81 949.78,-282.75 968.66,-255.64 982.32,-235.48"/>
<polygon fill="#6b7280" stroke="#6b7280" points="985.05,-237.7 987.73,-227.45 979.24,-233.78 985.05,-237.7"/>
</g>
<!-- keycloak -->
<g id="node13" class="node">
<title>keycloak</title>
<path fill="#fbcfe8" stroke="black" d="M2160.38,-505.68C2160.38,-507.78 2141.83,-509.49 2119,-509.49 2096.17,-509.49 2077.62,-507.78 2077.62,-505.68 2077.62,-505.68 2077.62,-471.37 2077.62,-471.37 2077.62,-469.27 2096.17,-467.56 2119,-467.56 2141.83,-467.56 2160.38,-469.27 2160.38,-471.37 2160.38,-471.37 2160.38,-505.68 2160.38,-505.68"/>
<path fill="none" stroke="black" d="M2160.38,-505.68C2160.38,-503.58 2141.83,-501.87 2119,-501.87 2096.17,-501.87 2077.62,-503.58 2077.62,-505.68"/>
<text xml:space="preserve" text-anchor="middle" x="2119" y="-490.28" font-family="Helvetica,sans-Serif" font-size="10.00">Keycloak</text>
<text xml:space="preserve" text-anchor="middle" x="2119" y="-479.03" font-family="Helvetica,sans-Serif" font-size="10.00">OIDC + ROPC</text>
</g>
<!-- connect_p&#45;&gt;keycloak -->
<g id="edge8" class="edge">
<title>connect_p&#45;&gt;keycloak</title>
<path fill="none" stroke="#ec4899" stroke-dasharray="5,2" d="M866.22,-226.02C877.22,-249.96 899.22,-288.84 932,-305.81 956.38,-318.43 1894.21,-318.41 1920,-327.81 1993.72,-354.66 2060.68,-420.8 2094.95,-459.02"/>
<polygon fill="#ec4899" stroke="#ec4899" points="2091.91,-460.86 2101.16,-466.05 2097.16,-456.23 2091.91,-460.86"/>
<text xml:space="preserve" text-anchor="middle" x="2068.64" y="-361.58" font-family="Helvetica,sans-Serif" font-size="8.00">ROPC</text>
</g>
<!-- connect_p&#45;&gt;crd_sess -->
<g id="edge11" class="edge">
<title>connect_p&#45;&gt;crd_sess</title>
<path fill="none" stroke="#22c55e" d="M835.92,-183.56C816.78,-166.03 788.26,-140.11 763,-118 749.18,-105.9 733.65,-92.7 720.57,-81.68"/>
<polygon fill="#22c55e" stroke="#22c55e" points="723.01,-79.17 713.11,-75.42 718.51,-84.53 723.01,-79.17"/>
<text xml:space="preserve" text-anchor="middle" x="814.37" y="-123.9" font-family="Helvetica,sans-Serif" font-size="8.00">find/create session</text>
</g>
<!-- sc1 -->
<g id="node19" class="node">
<title>sc1</title>
<polygon fill="#e9d5ff" stroke="black" points="1453.88,-74 1372.12,-74 1368.12,-70 1368.12,-38 1449.88,-38 1453.88,-42 1453.88,-74"/>
<polyline fill="none" stroke="black" points="1449.88,-70 1368.12,-70"/>
<polyline fill="none" stroke="black" points="1449.88,-70 1449.88,-38"/>
<polyline fill="none" stroke="black" points="1449.88,-70 1453.88,-74"/>
<text xml:space="preserve" text-anchor="middle" x="1411" y="-57.75" font-family="Helvetica,sans-Serif" font-size="10.00">SparkApp</text>
<text xml:space="preserve" text-anchor="middle" x="1411" y="-46.5" font-family="Helvetica,sans-Serif" font-size="10.00">(Connect :8424)</text>
</g>
<!-- connect_p&#45;&gt;sc1 -->
<g id="edge13" class="edge">
<title>connect_p&#45;&gt;sc1</title>
<path fill="none" stroke="#3b82f6" d="M876.31,-183.81C890.15,-170.05 910.41,-152.77 932,-144 968.39,-129.23 982.2,-146.64 1020,-136 1037.41,-131.1 1039.3,-123.59 1056.5,-118 1159.59,-84.49 1285.87,-68.38 1356.49,-61.48"/>
<polygon fill="#3b82f6" stroke="#3b82f6" points="1346.66,-65.43 1356.49,-61.48 1346.34,-58.43 1346.66,-65.43"/>
<text xml:space="preserve" text-anchor="middle" x="1078.25" y="-123.9" font-family="Helvetica,sans-Serif" font-size="8.00">gRPC proxy</text>
</g>
<!-- thrift_p&#45;&gt;keycloak -->
<g id="edge9" class="edge">
<title>thrift_p&#45;&gt;keycloak</title>
<path fill="none" stroke="#ec4899" stroke-dasharray="5,2" d="M725.15,-225.89C734.67,-249.32 753.9,-287.3 784,-305.81 1272.64,-606.22 1524.51,-265.3 2066,-454.53 2071.49,-456.44 2077,-459 2082.29,-461.86"/>
<polygon fill="#ec4899" stroke="#ec4899" points="2080.41,-464.81 2090.81,-466.84 2083.95,-458.77 2080.41,-464.81"/>
<text xml:space="preserve" text-anchor="middle" x="1964.64" y="-361.58" font-family="Helvetica,sans-Serif" font-size="8.00">ROPC</text>
</g>
<!-- thrift_p&#45;&gt;crd_sess -->
<g id="edge12" class="edge">
<title>thrift_p&#45;&gt;crd_sess</title>
<path fill="none" stroke="#22c55e" d="M708.08,-183.66C702.16,-170.44 695.18,-152.61 692,-136 688.85,-119.52 688.48,-100.76 688.95,-85.65"/>
<polygon fill="#22c55e" stroke="#22c55e" points="692.43,-86.1 689.41,-75.95 685.44,-85.77 692.43,-86.1"/>
<text xml:space="preserve" text-anchor="middle" x="725" y="-123.9" font-family="Helvetica,sans-Serif" font-size="8.00">find/create session</text>
</g>
<!-- st1 -->
<g id="node21" class="node">
<title>st1</title>
<polygon fill="#e9d5ff" stroke="black" points="1608,-74 1506,-74 1502,-70 1502,-38 1604,-38 1608,-42 1608,-74"/>
<polyline fill="none" stroke="black" points="1604,-70 1502,-70"/>
<polyline fill="none" stroke="black" points="1604,-70 1604,-38"/>
<polyline fill="none" stroke="black" points="1604,-70 1608,-74"/>
<text xml:space="preserve" text-anchor="middle" x="1555" y="-57.75" font-family="Helvetica,sans-Serif" font-size="10.00">SparkApp</text>
<text xml:space="preserve" text-anchor="middle" x="1555" y="-46.5" font-family="Helvetica,sans-Serif" font-size="10.00">(Thrift HTTP :10001)</text>
</g>
<!-- thrift_p&#45;&gt;st1 -->
<g id="edge14" class="edge">
<title>thrift_p&#45;&gt;st1</title>
<path fill="none" stroke="#f59e0b" d="M733.47,-183.71C745.53,-169.71 763.6,-152.17 784,-144 817.12,-130.73 1070.59,-145.41 1105,-136 1120.83,-131.67 1121.41,-122.32 1137.25,-118 1174.11,-107.95 1444.76,-122.1 1481,-110 1481.12,-109.96 1481.23,-109.92 1481.35,-109.88"/>
<polygon fill="#f59e0b" stroke="#f59e0b" points="1482.64,-113.14 1490.6,-106.15 1480.02,-106.65 1482.64,-113.14"/>
<text xml:space="preserve" text-anchor="middle" x="1173.62" y="-128.4" font-family="Helvetica,sans-Serif" font-size="8.00">HTTP reverse proxy</text>
<text xml:space="preserve" text-anchor="middle" x="1173.62" y="-119.4" font-family="Helvetica,sans-Serif" font-size="8.00">/cliservice</text>
</g>
<!-- gateway&#45;&gt;keycloak -->
<g id="edge10" class="edge">
<title>gateway&#45;&gt;keycloak</title>
<path fill="none" stroke="#ec4899" stroke-dasharray="5,2" d="M1010.21,-226.15C1020.81,-249.47 1041.56,-286.97 1072,-305.81 1451.87,-540.83 1646.8,-300.22 2066,-454.53 2071.39,-456.51 2076.82,-459.09 2082.05,-461.93"/>
<polygon fill="#ec4899" stroke="#ec4899" points="2080.07,-464.83 2090.47,-466.86 2083.61,-458.79 2080.07,-464.83"/>
<text xml:space="preserve" text-anchor="middle" x="1965.43" y="-361.58" font-family="Helvetica,sans-Serif" font-size="8.00">verify</text>
</g>
<!-- pool_ctrl -->
<g id="node11" class="node">
<title>pool_ctrl</title>
<polygon fill="#a7f3d0" stroke="black" points="633.98,-204.9 579.99,-229.81 472.01,-229.81 418.02,-204.9 472.01,-180 579.99,-180 633.98,-204.9"/>
<text xml:space="preserve" text-anchor="middle" x="526" y="-206.65" font-family="Helvetica,sans-Serif" font-size="10.00">Pool Controller</text>
<text xml:space="preserve" text-anchor="middle" x="526" y="-195.4" font-family="Helvetica,sans-Serif" font-size="10.00">scaling / ingress / lifecycle</text>
</g>
<!-- crd_pool -->
<g id="node14" class="node">
<title>crd_pool</title>
<polygon fill="#bfdbfe" stroke="black" points="588.12,-74 497.88,-74 497.88,-38 594.12,-38 594.12,-68 588.12,-74"/>
<polyline fill="none" stroke="black" points="588.12,-74 588.12,-68"/>
<polyline fill="none" stroke="black" points="594.12,-68 588.12,-68"/>
<text xml:space="preserve" text-anchor="middle" x="546" y="-57.75" font-family="Helvetica,sans-Serif" font-size="10.00">SparkSessionPool</text>
<text xml:space="preserve" text-anchor="middle" x="546" y="-46.5" font-family="Helvetica,sans-Serif" font-size="10.00">CRD</text>
</g>
<!-- pool_ctrl&#45;&gt;crd_pool -->
<g id="edge15" class="edge">
<title>pool_ctrl&#45;&gt;crd_pool</title>
<path fill="none" stroke="#22c55e" d="M530.37,-168.59C532.33,-153.07 534.71,-134.62 537,-118 538.46,-107.41 540.15,-95.79 541.67,-85.56"/>
<polygon fill="#22c55e" stroke="#22c55e" points="526.92,-167.96 529.15,-178.32 533.86,-168.83 526.92,-167.96"/>
<polygon fill="#22c55e" stroke="#22c55e" points="545.11,-86.25 543.13,-75.84 538.18,-85.21 545.11,-86.25"/>
<text xml:space="preserve" text-anchor="middle" x="547.5" y="-123.9" font-family="Helvetica,sans-Serif" font-size="8.00">watch</text>
</g>
<!-- pool_ctrl&#45;&gt;crd_sess -->
<g id="edge19" class="edge">
<title>pool_ctrl&#45;&gt;crd_sess</title>
<path fill="none" stroke="#22c55e" stroke-dasharray="5,2" d="M553.25,-179.65C583.57,-152.65 632.33,-109.24 662.97,-81.96"/>
<polygon fill="#22c55e" stroke="#22c55e" points="665.2,-84.65 670.34,-75.39 660.55,-79.43 665.2,-84.65"/>
<text xml:space="preserve" text-anchor="middle" x="644.25" y="-123.9" font-family="Helvetica,sans-Serif" font-size="8.00">count sessions</text>
</g>
<!-- sparkapp -->
<g id="node16" class="node">
<title>sparkapp</title>
<polygon fill="#bfdbfe" stroke="black" points="871.75,-74 788.25,-74 788.25,-38 877.75,-38 877.75,-68 871.75,-74"/>
<polyline fill="none" stroke="black" points="871.75,-74 871.75,-68"/>
<polyline fill="none" stroke="black" points="877.75,-68 871.75,-68"/>
<text xml:space="preserve" text-anchor="middle" x="833" y="-57.75" font-family="Helvetica,sans-Serif" font-size="10.00">SparkApplication</text>
<text xml:space="preserve" text-anchor="middle" x="833" y="-46.5" font-family="Helvetica,sans-Serif" font-size="10.00">CRD</text>
</g>
<!-- pool_ctrl&#45;&gt;sparkapp -->
<g id="edge16" class="edge">
<title>pool_ctrl&#45;&gt;sparkapp</title>
<path fill="none" stroke="#a855f7" d="M566.42,-179.51C590.4,-166.39 621.9,-151.41 652,-144 663.01,-141.29 848.14,-144.18 856,-136 869.41,-122.06 862.19,-100.76 852.42,-83.79"/>
<polygon fill="#a855f7" stroke="#a855f7" points="855.6,-82.27 847.32,-75.67 849.68,-86 855.6,-82.27"/>
<text xml:space="preserve" text-anchor="middle" x="886.49" y="-123.9" font-family="Helvetica,sans-Serif" font-size="8.00">create/delete</text>
</g>
<!-- ingress_api -->
<g id="node17" class="node">
<title>ingress_api</title>
<polygon fill="#bfdbfe" stroke="black" points="352.5,-74 291.5,-74 291.5,-38 358.5,-38 358.5,-68 352.5,-74"/>
<polyline fill="none" stroke="black" points="352.5,-74 352.5,-68"/>
<polyline fill="none" stroke="black" points="358.5,-68 352.5,-68"/>
<text xml:space="preserve" text-anchor="middle" x="325" y="-52.12" font-family="Helvetica,sans-Serif" font-size="10.00">Ingress API</text>
</g>
<!-- pool_ctrl&#45;&gt;ingress_api -->
<g id="edge17" class="edge">
<title>pool_ctrl&#45;&gt;ingress_api</title>
<path fill="none" stroke="#f59e0b" d="M476.83,-179.55C449.76,-167.11 415.2,-152.78 383,-144 370.34,-140.55 333.13,-145.89 324.5,-136 312.63,-122.4 313.1,-101.9 316.36,-85.19"/>
<polygon fill="#f59e0b" stroke="#f59e0b" points="319.67,-86.37 318.59,-75.83 312.86,-84.75 319.67,-86.37"/>
<text xml:space="preserve" text-anchor="middle" x="340.25" y="-123.9" font-family="Helvetica,sans-Serif" font-size="8.00">reconcile</text>
</g>
<!-- metrics_api -->
<g id="node18" class="node">
<title>metrics_api</title>
<polygon fill="#bfdbfe" stroke="black" points="455.5,-74 394.5,-74 394.5,-38 461.5,-38 461.5,-68 455.5,-74"/>
<polyline fill="none" stroke="black" points="455.5,-74 455.5,-68"/>
<polyline fill="none" stroke="black" points="461.5,-68 455.5,-68"/>
<text xml:space="preserve" text-anchor="middle" x="428" y="-57.75" font-family="Helvetica,sans-Serif" font-size="10.00">Metrics API</text>
<text xml:space="preserve" text-anchor="middle" x="428" y="-46.5" font-family="Helvetica,sans-Serif" font-size="10.00">(cpu/mem)</text>
</g>
<!-- pool_ctrl&#45;&gt;metrics_api -->
<g id="edge18" class="edge">
<title>pool_ctrl&#45;&gt;metrics_api</title>
<path fill="none" stroke="#6b7280" stroke-dasharray="5,2" d="M469.64,-180.56C424.81,-161.87 369.31,-138.37 367.75,-136 363.35,-129.32 364.42,-125.28 367.75,-118 370.01,-113.06 373.06,-113.74 377,-110 386.27,-101.21 396.08,-91.2 404.6,-82.26"/>
<polygon fill="#6b7280" stroke="#6b7280" points="406.95,-84.87 411.26,-75.2 401.86,-80.07 406.95,-84.87"/>
<text xml:space="preserve" text-anchor="middle" x="388.38" y="-123.9" font-family="Helvetica,sans-Serif" font-size="8.00">pod metrics</text>
</g>
<!-- sess_ctrl -->
<g id="node12" class="node">
<title>sess_ctrl</title>
<polygon fill="#a7f3d0" stroke="black" points="1294.47,-204.9 1243.24,-229.81 1140.76,-229.81 1089.53,-204.9 1140.76,-180 1243.24,-180 1294.47,-204.9"/>
<text xml:space="preserve" text-anchor="middle" x="1192" y="-206.65" font-family="Helvetica,sans-Serif" font-size="10.00">Session Controller</text>
<text xml:space="preserve" text-anchor="middle" x="1192" y="-195.4" font-family="Helvetica,sans-Serif" font-size="10.00">assignment / idle timeout</text>
</g>
<!-- sess_ctrl&#45;&gt;crd_sess -->
<g id="edge20" class="edge">
<title>sess_ctrl&#45;&gt;crd_sess</title>
<path fill="none" stroke="#22c55e" d="M1142.43,-174.11C1121.41,-162.83 1096.21,-151.03 1072,-144 1038.53,-134.28 1028.35,-141.86 994,-136 960.21,-130.24 952.92,-122.94 919,-118 886.19,-113.22 801.45,-120.5 770,-110 751.62,-103.86 733.5,-92.22 719.26,-81.41"/>
<polygon fill="#22c55e" stroke="#22c55e" points="1140.61,-177.1 1151.06,-178.85 1143.98,-170.97 1140.61,-177.1"/>
<polygon fill="#22c55e" stroke="#22c55e" points="721.7,-78.88 711.68,-75.43 717.36,-84.37 721.7,-78.88"/>
<text xml:space="preserve" text-anchor="middle" x="1004.5" y="-123.9" font-family="Helvetica,sans-Serif" font-size="8.00">watch</text>
</g>
<!-- sess_ctrl&#45;&gt;sparkapp -->
<g id="edge21" class="edge">
<title>sess_ctrl&#45;&gt;sparkapp</title>
<path fill="none" stroke="#a855f7" stroke-dasharray="5,2" d="M1210.88,-179.56C1222.96,-160.85 1233.83,-135.35 1219,-118 1177.29,-69.18 986.19,-59.2 889.45,-57.32"/>
<polygon fill="#a855f7" stroke="#a855f7" points="889.71,-53.83 879.65,-57.16 889.59,-60.82 889.71,-53.83"/>
<text xml:space="preserve" text-anchor="middle" x="1248.08" y="-123.9" font-family="Helvetica,sans-Serif" font-size="8.00">find instance</text>
</g>
<!-- hive -->
<g id="node25" class="node">
<title>hive</title>
<path fill="#fef9c3" stroke="black" d="M1940.38,-503.25C1940.38,-505.06 1921.83,-506.53 1899,-506.53 1876.17,-506.53 1857.62,-505.06 1857.62,-503.25 1857.62,-503.25 1857.62,-473.8 1857.62,-473.8 1857.62,-471.99 1876.17,-470.53 1899,-470.53 1921.83,-470.53 1940.38,-471.99 1940.38,-473.8 1940.38,-473.8 1940.38,-503.25 1940.38,-503.25"/>
<path fill="none" stroke="black" d="M1940.38,-503.25C1940.38,-501.45 1921.83,-499.98 1899,-499.98 1876.17,-499.98 1857.62,-501.45 1857.62,-503.25"/>
<text xml:space="preserve" text-anchor="middle" x="1899" y="-484.65" font-family="Helvetica,sans-Serif" font-size="10.00">Hive Metastore</text>
</g>
<!-- sc1&#45;&gt;hive -->
<g id="edge22" class="edge">
<title>sc1&#45;&gt;hive</title>
<path fill="none" stroke="#a855f7" stroke-dasharray="5,2" d="M1428.2,-74.24C1441.8,-86.66 1461.95,-102.49 1483,-110 1499.35,-115.84 1626.06,-106.44 1639,-118 1702.08,-174.37 1627.1,-232.89 1670,-305.81 1714.03,-380.65 1801.5,-436.62 1854.67,-465.52"/>
<polygon fill="#a855f7" stroke="#a855f7" points="1853.02,-468.6 1863.49,-470.22 1856.31,-462.42 1853.02,-468.6"/>
</g>
<!-- s3 -->
<g id="node26" class="node">
<title>s3</title>
<path fill="#fef9c3" stroke="black" d="M2041.38,-503.25C2041.38,-505.06 2026.86,-506.53 2009,-506.53 1991.14,-506.53 1976.62,-505.06 1976.62,-503.25 1976.62,-503.25 1976.62,-473.8 1976.62,-473.8 1976.62,-471.99 1991.14,-470.53 2009,-470.53 2026.86,-470.53 2041.38,-471.99 2041.38,-473.8 2041.38,-473.8 2041.38,-503.25 2041.38,-503.25"/>
<path fill="none" stroke="black" d="M2041.38,-503.25C2041.38,-501.45 2026.86,-499.98 2009,-499.98 1991.14,-499.98 1976.62,-501.45 1976.62,-503.25"/>
<text xml:space="preserve" text-anchor="middle" x="2009" y="-484.65" font-family="Helvetica,sans-Serif" font-size="10.00">S3 Storage</text>
</g>
<!-- sc1&#45;&gt;s3 -->
<g id="edge23" class="edge">
<title>sc1&#45;&gt;s3</title>
<path fill="none" stroke="#a855f7" stroke-dasharray="5,2" d="M1428.17,-74.32C1441.76,-86.77 1461.9,-102.62 1483,-110 1504.73,-117.6 1671.75,-103.97 1690,-118 1746.87,-161.72 1676.47,-388.66 1728,-438.56 1746.4,-456.38 1933.7,-446.42 1958,-454.53 1964.96,-456.85 1971.9,-460.34 1978.32,-464.2"/>
<polygon fill="#a855f7" stroke="#a855f7" points="1976.36,-467.1 1986.65,-469.63 1980.18,-461.23 1976.36,-467.1"/>
</g>
<!-- sc2 -->
<g id="node20" class="node">
<title>sc2</title>
<polygon fill="#e9d5ff" stroke="black" points="1444.38,-506.53 1389.62,-506.53 1385.62,-502.53 1385.62,-470.53 1440.38,-470.53 1444.38,-474.53 1444.38,-506.53"/>
<polyline fill="none" stroke="black" points="1440.38,-502.53 1385.62,-502.53"/>
<polyline fill="none" stroke="black" points="1440.38,-502.53 1440.38,-470.53"/>
<polyline fill="none" stroke="black" points="1440.38,-502.53 1444.38,-506.53"/>
<text xml:space="preserve" text-anchor="middle" x="1415" y="-484.65" font-family="Helvetica,sans-Serif" font-size="10.00">SparkApp</text>
</g>
<!-- st1&#45;&gt;hive -->
<g id="edge24" class="edge">
<title>st1&#45;&gt;hive</title>
<path fill="none" stroke="#a855f7" stroke-dasharray="5,2" d="M1608.23,-64.42C1650.25,-72.3 1708.79,-87.95 1752,-118 1865.35,-196.83 1748.71,-302.14 1818,-421.56 1827.95,-438.7 1844.17,-453.24 1859.49,-464.26"/>
<polygon fill="#a855f7" stroke="#a855f7" points="1857.38,-467.05 1867.61,-469.81 1861.33,-461.27 1857.38,-467.05"/>
</g>
<!-- st1&#45;&gt;s3 -->
<g id="edge25" class="edge">
<title>st1&#45;&gt;s3</title>
<path fill="none" stroke="#a855f7" stroke-dasharray="5,2" d="M1573.88,-74.26C1620.46,-116.9 1744.43,-230.81 1846,-327.81 1895.19,-374.78 1951.7,-430.57 1983.6,-462.23"/>
<polygon fill="#a855f7" stroke="#a855f7" points="1980.9,-464.49 1990.46,-469.06 1985.84,-459.52 1980.9,-464.49"/>
</g>
<!-- st2 -->
<g id="node22" class="node">
<title>st2</title>
<polygon fill="#e9d5ff" stroke="black" points="1584.38,-506.53 1529.62,-506.53 1525.62,-502.53 1525.62,-470.53 1580.38,-470.53 1584.38,-474.53 1584.38,-506.53"/>
<polyline fill="none" stroke="black" points="1580.38,-502.53 1525.62,-502.53"/>
<polyline fill="none" stroke="black" points="1580.38,-502.53 1580.38,-470.53"/>
<polyline fill="none" stroke="black" points="1580.38,-502.53 1584.38,-506.53"/>
<text xml:space="preserve" text-anchor="middle" x="1555" y="-484.65" font-family="Helvetica,sans-Serif" font-size="10.00">SparkApp</text>
</g>
<!-- pool_n_placeholder -->
<g id="node23" class="node">
<title>pool_n_placeholder</title>
<polygon fill="#f1f5f9" stroke="#cbd5e1" points="1706.38,-506.53 1651.62,-506.53 1647.62,-502.53 1647.62,-470.53 1702.38,-470.53 1706.38,-474.53 1706.38,-506.53"/>
<polyline fill="none" stroke="#cbd5e1" points="1702.38,-502.53 1647.62,-502.53"/>
<polyline fill="none" stroke="#cbd5e1" points="1702.38,-502.53 1702.38,-470.53"/>
<polyline fill="none" stroke="#cbd5e1" points="1702.38,-502.53 1706.38,-506.53"/>
<text xml:space="preserve" text-anchor="middle" x="1677" y="-490.28" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#94a3b8">SparkApp</text>
<text xml:space="preserve" text-anchor="middle" x="1677" y="-479.03" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#94a3b8">...</text>
</g>
<!-- pool_m_placeholder -->
<g id="node24" class="node">
<title>pool_m_placeholder</title>
<polygon fill="#f1f5f9" stroke="#cbd5e1" points="1804.38,-506.53 1749.62,-506.53 1745.62,-502.53 1745.62,-470.53 1800.38,-470.53 1804.38,-474.53 1804.38,-506.53"/>
<polyline fill="none" stroke="#cbd5e1" points="1800.38,-502.53 1745.62,-502.53"/>
<polyline fill="none" stroke="#cbd5e1" points="1800.38,-502.53 1800.38,-470.53"/>
<polyline fill="none" stroke="#cbd5e1" points="1800.38,-502.53 1804.38,-506.53"/>
<text xml:space="preserve" text-anchor="middle" x="1775" y="-490.28" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#94a3b8">SparkApp</text>
<text xml:space="preserve" text-anchor="middle" x="1775" y="-479.03" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#94a3b8">...</text>
</g>
</g>
</svg>
